function fmat = mkfatthinmat2( n, radiusP, supportk, alpha, ringp, bglum, indcst, fixation, noisestd, control )% MKFATTHINMAT  Make matrix showing a fat/thin Kanisza figure%% fmat = mkfatthinmat2( n, radiusP, supportk, alpha, ringp, bglum, indcst, fixation, noisestd, control )% 02-Jun-99 -- created (RFM)% set default argumentsdefarg('indcst',1.0);defarg('noisestd',0);defarg('control',0);defarg('fixation',0);% determine centre positions of inducersview=[ 0 0 n n ];figRect=centrerect(view,(radiusP/supportk)*[ 0 0 1 1 ]);% get top-left inducerkmat=bglum*(1+indcst*kanind2(radiusP,alpha,ringp));indRect=[ 0 0 size(kmat) ]-floor(size(kmat,1)/2);  % assumes kmat is square% initialize matrixfmat=bglum*ones(n,n);% place top-left inducerindOff=figRect([ 1 2 ]);dstRect=[ indOff indOff ]+indRect;fmat((dstRect(2)+1):dstRect(4),(dstRect(1)+1):dstRect(3))=kmat;% place top-right inducerindOff=figRect([ 3 2 ]);dstRect=[ indOff indOff ]+indRect;if control,	fmat((dstRect(2)+1):dstRect(4),(dstRect(1)+1):dstRect(3))=kmat;else	fmat((dstRect(2)+1):dstRect(4),(dstRect(1)+1):dstRect(3))=fliplr(kmat);end% place bottom-left inducerindOff=figRect([ 1 4 ]);dstRect=[ indOff indOff ]+indRect;if control,	fmat((dstRect(2)+1):dstRect(4),(dstRect(1)+1):dstRect(3))=kmat;else	fmat((dstRect(2)+1):dstRect(4),(dstRect(1)+1):dstRect(3))=flipud(kmat);end% place bottom-right inducerindOff=figRect([ 3 4 ]);dstRect=[ indOff indOff ]+indRect;if control,	fmat((dstRect(2)+1):dstRect(4),(dstRect(1)+1):dstRect(3))=kmat;else	fmat((dstRect(2)+1):dstRect(4),(dstRect(1)+1):dstRect(3))=fliplr(flipud(kmat));endif fixation	% draw fixation point	fixRect=centrerect(view,[ 0 0 3 3 ]);	fmat((fixRect(2)+1):fixRect(4),(fixRect(1)+1):fixRect(3))=bglum*(1+indcst);end% add noiseif noisestd>0,	fmat=fmat+random('norm',0,bglum*noisestd,size(fmat));endreturn