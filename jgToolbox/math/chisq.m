function [results] = chisq(var1,var2)% function [results] = chisq(var1,var2)%% chi square test for 2 sets of corresponding% frequency counts in VAR1 and VAR2. % VAR1 and VAR2 must be the same size (i.e.,% the same number of bins). results are output % as a struct and printed to the screen.%% DEPENDENCIES: requires 'chi2pdf' from matlab stats toolbox%% adapted from Hays, W (1981).  Statistics. (p.539).%% March 2 1999  JMG U of T Visionif length(var1) == length(var2)	% total number of observations	results.n = sum(var1);		% degrees of freedom (# of conditions - 1)	results.df = length(var1)-1;		% chi-square test	results.chi = sum( ((var1-var2).^2)./var2 );		% chi square probability density function	% see matlab stats toolbox	results.prob =chi2pdf(results.chi,results.df);		% output to screen	fprintf(1,'\n');	fprintf(1,['          n: ',num2str(results.n),'\n']);	fprintf(1,['         df: ',num2str(results.df),'\n']);	fprintf(1,['        chi: ',num2str(results.chi),'\n']);	fprintf(1,['       prob: ',num2str(results.prob),'\n']);	fprintf(1,'\n');	else	% error message	fprintf(1,'Number of bins must be equal.\n');	endreturn;