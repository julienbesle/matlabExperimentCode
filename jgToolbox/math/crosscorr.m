function c = crosscorr(a,b,method)% function c = crosscorr(a,b,method)%% 1- or 2-d cross correlation.% uses MATLAB convolution functions% produces same result as matlab XCORR.defarg('method','fourier');if size(a) ~= size(b)	printstr('matrices must be the same size');	return;end% convolutionif strcmp(method,'conv')	if size(a,2)<size(a,1);		a = a';		b = b';	end	if min(size(a))==1			c = conv(fliplr(a),b);	else		c = conv2(fliplr(flipud(a)),b);	end	elseif strcmp(method,'fourier')	if min(size(a))==1			if size(a,2)<size(a,1);			a = a';			b = b';		end		a = [a,zeros(size(a))];		b = [b,zeros(size(b))];		c = fftshift(real(ifft(fft(a).*conj(fft(b)))));	else		n = size(a,1);		biga = zeros(n*3);		bigb = biga;		biga(n+1:2*n,n+1:2*n) = a;		bigb(n+1:2*n,n+1:2*n) = b;		a=biga;		b=bigb;		c = fliplr(flipud(fftshift(real(ifft2(fft2(a).*conj(fft2(b)))))));	end	else	printstr('not a valid method');	return;endreturn;