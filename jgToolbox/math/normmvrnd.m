function r = normrndmv( mu, sigma, n )% NORMRNDMV  Multivariate normal random variable%% r = normrndmv( mu, sigma, n )% 26-Aug-98 -- created (RFM)% set default argumentsdefarg('n',1);% vectorize mean and get dimensionmu=mu(:);D=size(mu,1);% transform separable multivariate normal distribution N(0,1)[u,s,v]=svd(sigma);t=u*sqrt(s);r=(mu*ones(1,n))+t*randn(D,n);return