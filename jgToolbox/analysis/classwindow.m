function classwindow(windowsize,stepsize)jg local;defarg('windowsize',1000);defarg('stepsize',windowsize);[file,folder] = uigetfile('*.dat','Choose File');[idealfile,idealfolder] = uigetfile('*.mat','Choose Ideal Image');if file,		% set ideal template to unit energy	load([idealfolder,idealfile]);		idealtemp = idealtemp./sqrt(sum(sum(idealtemp.^2)));		data = readdata(file,folder);	responses = data(:,response);	sequences = data(:,sequence);	numits = floor((size(data,1)-windowsize)/stepsize) + 1;	runningc = zeros([imagesize imagesize]); 	for i = 1:numits,		s1r1 = zeros([imagesize imagesize]);		s1r2 = s1r1;		s2r1 = s1r1;		s2r2 = s1r1;		s1r1trials = 0;		s2r1trials = s1r1trials;		s1r2trials = s1r1trials;		s2r2trials = s1r1trials;		fprintf(1,'\n\n\n\n\n')		for currtrial = i*stepsize-stepsize+1:i*stepsize-stepsize+windowsize,				randn('state',[data(currtrial,randnstate1);data(currtrial,randnstate2)]);			nz=cliprandn([imagesize imagesize],2);			nz=nz*sqrt(noisevar/std(nz(:))^2);			eval(['s',num2str(sequences(currtrial)),'r',num2str(responses(currtrial)),'= s',num2str(sequences(currtrial)),'r',num2str(responses(currtrial)),'+nz;']);				eval(['s',num2str(sequences(currtrial)),'r',num2str(responses(currtrial)),'trials = s',num2str(sequences(currtrial)),'r',num2str(responses(currtrial)),'trials+1;']);				fprintf(1,'\b\b\b\b%4d',currtrial);		end		fprintf(1,'\n');		c = [(s1r1/s1r1trials+s2r1/s2r1trials) - (s1r2/s1r2trials+s2r2/s2r2trials)];		runningc = runningc+c;						% set raw classification image to unit variance		%cc(i) = sum(sum(idealtemp.*c));		rawclassvar = (stdm(c))^2;		normrawclass = c.*sqrt(1/rawclassvar);		cc(i) = sum(sum(idealtemp.*normrawclass));		p(i) = normcdf(-cc(i),0,1);			subplot(3,1,1);		imshow(scale(runningc));		subplot(3,1,2);		plot([1:length(cc)],cc,'r-*');		xlabel('Time');		ylabel('Similarity');		subplot(3,1,3);		plot([1:length(p)],p,'r-*');		xlabel('Time');		ylabel('p-level');		drawnow;	end		cd(folder);	newfile = [rmextension(file),'.wincor'];	f = fopen([folder,newfile],'w+');	savedatetime(f);	savecomment(f,'Cross correlation of observer template with ideal template.');	savecomment(f,'Computed with roving window.');	savecommand(f,vars2str(file));	savecommand(f,vars2str(idealfile));		savecommand(f,vars2str(windowsize));		savecommand(f,'crosscorr = 1; plevel = 2;');	for i = 1:length(cc),		fprintf(f,'%g\t',[cc(i),p(i)]);		fprintf(f,'\n');	end		fclose(f);	endreturn		