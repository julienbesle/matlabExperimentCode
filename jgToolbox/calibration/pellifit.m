function [coeffs] = pellifit(d1,d2,init)% function [coeffs] = pellifit(d1,d2,init)%% fits a 4 parameter gamma function to the data [d1], [d2]% using the function pellipower. [init] are the initial% estimates for the parameters. defaults are used if not passed.% the fit is weighted by 1/(d2*.01). See pellipower for more% details on the fitting function. Least-squares minimization is% used (fmins). returns the coefficients of the fit in a 4 element% vector.% % Dependencies: pellipower%% July 1998  JMG  U of T Vision Lab% the datadata = [d1,d2,(1./(d2*0.1))];% default valuesif nargin <= 2	init(1) = min(d2);	init(2) = .01;	init(3) = .01;	init(4) = 2;end	% inline function for least-squares fiterrfn = inline('sum(((pellipower([x(1),x(2),x(3),x(4)],P1(:,1)) - P1(:,2)).^2)./P1(:,3))','x','P1');% maximum interationsoptions=foptions;options(14)=10000;% minimizecoeffs = fmins(errfn,init,options,[],data);return