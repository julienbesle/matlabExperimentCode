function lum = pellipower(coeffs,values)% function lum = pellipower(coeffs,value)%% the value of the pelli gamma function at the values% passed in [values]. [values] can be a scalar or a vector.% the function is defined as:% coeffs = [alpha beta kappa gamma]%%	L(v)/cdm^2 = a + (b + kv)^g  {if b + kv >= 0}%				 a				 {otherwise}%% From:  Pelli, D.G. & Zhang, L. (1991). "Accurate control% 		 of contrast on microcomputer displays". Vision %		 Research, 31-7/8, 1137-1350.%% Dependencies: none.%% July 1998  JMG U of T Vision Lablocs=find(coeffs(2)+coeffs(3)*values<0);lum = coeffs(1) + (coeffs(2)+coeffs(3)*values).^coeffs(4);lum(locs) = coeffs(1);return