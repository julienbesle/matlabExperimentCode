function trialsrc = mkquest( levels, threshlev, accuracy, id )% MKQUEST  Make a QUEST trial source%% trialsrc = mkquest( levels, threshlev, accuracy, id )% 22-Apr-98 -- created (RFM)% set default argumentsdefarg('threshlev',0.75);defarg('accuracy',0);defarg('id',-1);trialsrc.type='quest';           % typetrialsrc.levels=levels(:)';      % stimulus levelstrialsrc.interval=accuracy;      % desired certainty leveltrialsrc.id=id;                  % trial source id% create success and failure functions%mul=exp(1-weibullinv(2*(threshlev-0.5),1,2));mul=sqrt(1/(-log(2*(1-threshlev))));trialsrc.successfn=inline(sprintf( ...	'0.5+0.5*weibullcdf(stimlevel,threshlevel*%f,%f)',mul,2),'stimlevel','threshlevel');% initialize posterior pdf with prior pdftrialsrc.pdf=normpdf(levels,mean(levels),levels(end)-levels(1));trialsrc.pdf=trialsrc.pdf/sum(trialsrc.pdf);trialsrc.final=NaN;  % final estimate will be entered heretrialsrc.trial=0;    % trial countreturn