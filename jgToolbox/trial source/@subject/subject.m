function sub = subject( type, threshlev, threshval, spread, gamma, delta )% SUBJECT  Initialize a Bernoulli model of a subject in a 2AFC task%% sub = subject( type, threshlev, threshval, spread, gamma, delta )% 12-Aug-98 -- arguments gamma, delta added (RFM)% 27-Sep-98 -- made object-oriented (RFM)% set default argumentsdefarg('gamma',0.5);   % chance performance leveldefarg('delta',0.01);  % guessing rate% set psychometric function typeif (~strcmp(type,'norm')) & (~strcmp(type,'weibull')),	error(sprintf('Invalid subject type ''%s''',type));endsub.type=type;% set parameters directlyif prod(size(threshlev))==2,	sub.p1=threshlev(1);	sub.p2=threshlev(2);	% hack	if nargin>=3,		gamma=threshval;	end	if nargin>=4,		delta=spread;	end% set parameters from thresholdelse	if strcmp(sub.type,'norm'),		sub.p1=threshval-norminv((threshlev-gamma)/((1-delta)-gamma),0,spread);	else		sub.p1=threshval/weibullinv((threshlev-gamma)/((1-delta)-gamma),1,spread);	end	sub.p2=spread;end% make inline psychometric functionsub.psymet=inline(sprintf('%f+%f*%scdf(x,%f,%f)',gamma,(1-delta)-gamma,sub.type,sub.p1,sub.p2));% create objectsub=class(sub,'subject');return