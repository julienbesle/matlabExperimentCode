function params = fitgenexp( dataset, highflag )% FITGENEXP  Fit a generalized exponential to data%% params = fitgenexp( dataset, highflag )% 04/05/98 - created (RFM)defarg('highflag',0);% make generalized exponentialfitfn=inline('genexp(x,p)','x','p');options = foptions;options(14) = 5000;% scale the data if it is small.on = 0;if on == 1temp = max(dataset(2,:));factor = log10(temp);scaled = 0;if factor < 0	dataset(2,:) = dataset(2,:)*10^(abs(factor));	scaled = 1;endend% make initial guessesgamma=1;delta=min(dataset(2,:));YR=max(dataset(2,:))-min(dataset(2,:));XR=max(dataset(1,:))-min(dataset(1,:));lambda=log(YR)/XR;if highflag,	x0=max(dataset(1,:));	lambda=-lambda;else	x0=min(dataset(1,:));end% fitparams=fit(fitfn,dataset,[ delta gamma lambda x0 ],'ss',options);if on == 1if scaled == 1	params(1) = params(1)/(10^(abs(factor)));	params(2) = params(2)/(10^(abs(factor)));endendreturn