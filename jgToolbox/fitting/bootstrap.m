function [ fit, stderr ] = bootstrap( trials, type, blocks, threshlev, gamma, delta, fname )% BOOTSTRAP  Fit a set of trials and bootstrap to find confidence intervals%% [ fit, stderr ] = bootstrap( trials, type, blocks, threshlev, gamma, delta, fname )% 24-Mar-98 -- created (RFM)% 12-Aug-98 -- arguments threshlev, gamma, delta added (RFM)% 21-Sep-98 -- argument fname added (RFM)% set default argumentsdefarg('type','weibull');defarg('blocks',100);defarg('threshlev',0.75);defarg('gamma',0.5);defarg('delta',0.01);defarg('fname','');% get fit and find threshold[ fp1 fp2 ] = fitpsymet( trials, type, [], gamma, delta );fthresh = getthresh( threshlev, type, [ fp1 fp2 ], gamma, delta );%fthresh75 = feval( [ type 'inv' ],0.5,fp1,fp2 );% make subject modelsub = mksubject( type, [ fp1 fp2 ], gamma, delta );% bootstraplevels=trials(:,1);fits=[];for i=1:blocks,	correct = pollsubject( sub, levels );	[ p1 p2 ] = fitpsymet( [ levels correct ], type );	thresh = getthresh( threshlev, type, [ p1 p2 ], gamma, delta );%	thresh75 = feval( [ type 'inv' ],0.5,p1,p2 );	fits = [ fits ; p1 p2 thresh ];	fprintf(1,'%d\t%.2f\t%.2f\t%.2f\n',i,p1,p2,thresh);endfit = [ fp1 fp2 fthresh ];stderr = std(fits);% save fits and standard errors to fileif ~isempty(fname),	save(fname,'fits','fit','stderr');endreturn