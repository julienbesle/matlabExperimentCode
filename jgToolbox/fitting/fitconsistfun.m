function [slope,data] = fitconsistfun( data, maxits )% function [slope,data] = fitconsistfun( data, maxits )%% data = [pa pc ntrials]%% returns: % p		--	fitted slope to function pc = log10(pa/100) + 100% data  --  data matrix in the form [pa pc ntrials stdpa stdpc]%% March 9 2000 jmg% set default argumentsdefarg('maxits',1000);% set parameters for fitsmind=min(data(:,1));maxd=max(data(:,2));step=(maxd-mind)/100;opt=foptions;opt(2)=step; 		%minlevel;   % parameter toleranceopt(3)=0.000001; 	% error toleranceopt(14)=maxits;   	% maximum number of iterationsinit = 100;% compute standard errorsdata = [data,sqrt(data(:,1).*(100-data(:,1))./(data(:,3)./2))];data = [data,sqrt(data(:,2).*(100-data(:,2))./(data(:,3)./2))];% error function% pc = w.*log10(pa/100) + 100% % pa = (10.^((pc - 100)/w))*100errfn = inline('sum(((x(1).*log10(P1(:,1)/100)+100 - P1(:,2)).^2)./(P1(:,4).^(-1)))',1);% minimizewarning off;slope = fmins(errfn,init,opt,[],data);warning on;return