function [ slope, intercept] = linfitfn( data, init )% function [ slope, intercept] = linfitfn( data, init )%% fits a line to data. data are independant and dependant% data, stored in a 2 column matrix. init are the initial values for% the parameters.%% May 1998  JMG U of T Vision Labif ~exist('init','var'),	maxrow = max(find(data(:,1)==max(data(:,1))));	minrow = max(find(data(:,1)==min(data(:,1))));	init(2) = (data(maxrow,2)-data(minrow,2))/(data(maxrow,1)-data(minrow,1));	init(1) = data(maxrow,2)-init(2)*data(maxrow,1);endif size(data,2) == 2	data = [data,ones(sz(1),1)];enderrfn = inline('sum( (((x(1) + x(2).*P1(:,1)) - P1(:,2)).^2)./P1(:,3))',1);options=foptions;options(14)=10000;fit = fmins(errfn,init,options,[],data);intercept=fit(1);slope=fit(2);return