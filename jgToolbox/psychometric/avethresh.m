function avethresh(file,folder);% look for file and folder namesif ~exist('file','var');	[file,folder] = uigetfile('*.dat','Choose First File');endif ~exist('folder','var')	folder = pwd;endif file	% for mutiple files	cd(folder)	currfiles = dir('*.psy');	[selectfiles,ok] = dolistdlg(currfiles,'name','Select All Files To Average:',[160 300],'multiple');	if ~ok		selectfiles = {file};	else		file = selectfiles{1};	end	allthresh = [];	allalpha = [];	allbeta = [];	if size(selectfiles,2) < 2		printstr('At least 2 files must be chosen.');		return;	end		for i = 1:size(selectfiles,2)					tempdata = readdata(selectfiles{i},folder);		if ~exist('conditions','var') |  ~exist('thresh','var')			printstr('Improper data format.');			return;		else			allthresh = [allthresh;thresh];			if exist('fitalpha','var')				allalpha = [allalpha;fitalpha];			end			if exist('fitbeta','var')				allbeta = [allbeta;fitbeta];			end		end			end			% data file	period=findstr(file,'.');	if isempty(period)==0,		file=file(1:period-1);	end	defarg('newfile',[file,'.ave']);	defarg('newfolder',folder);	meanthresh = mean(allthresh);	sethresh = std(allthresh)./sqrt(size(allthresh,1));		if exist('fitalpha','var')		meanalpha = mean(allalpha);		sealpha = std(allalpha)./sqrt(size(allalpha,1));				end	if exist('fitbeta','var')		meanbeta = mean(allbeta);		sebeta = std(allbeta)./sqrt(size(allbeta,1));				end	handle = figure;	mainaxis=axes('position',[0.1,0.1,0.8,0.8]);	set(mainaxis,'XScale','log'); hold on;	set(mainaxis,'YScale','log'); hold on;	handle=errorbar(conditions,meanthresh,sethresh,'r--');		xlabel('Condition');	ylabel(['Threshold']);	title([file,' Averaged Thresholds']);	[newfile,newfolder] = uiputfile([newfile],'Save Results As');	if newfile		fwid = fopen([newfolder,newfile],'w+');		savedatetime(fwid);		savecomment(fwid,['Fitted params and mean thresholds.']);		savecommand(fwid,['conditions = [',num2str(conditions),'];'])		savecommand(fwid,['thresh = [',num2str(meanthresh),'];'])		savecommand(fwid,['threshSE = [',num2str(sethresh),'];'])		if exist('fitalpha','var')			savecommand(fwid,['fitalpha = [',num2str(meanalpha),'];'])			savecommand(fwid,['fitalphaSE = [',num2str(sealpha),'];'])		end		if exist('fitbeta','var')			savecommand(fwid,['fitbeta = [',num2str(meanbeta),'];'])			savecommand(fwid,['fitbetaSE = [',num2str(sebeta),'];'])		end		fclose(fwid);		dat2igor(newfile,newfolder);		edit([newfolder,newfile]);		end	endreturn;	