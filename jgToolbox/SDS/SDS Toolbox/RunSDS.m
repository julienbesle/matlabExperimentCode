function [ Trials, Theta1, Theta2 ] = RunSDS( StimA, StimB, StimLev, ...	NTrials, Dist )% RunSDS - obtain psychometric function of SDS ideal observer%%      [ Trials, Theta1, Theta2 ] = RunSDS( StimA, StimB, StimLev,%                                           NTrials, Dist )%%     StimA, StimB - names of stimuli%     StimLev      - row matrix containing stimulus levels to be tested%     NTrials      - number of trials per stimulus level%     Dist         - name of CDF to use in fitting psychometric function%     Trials       - trials obtained from ideal observer%     Theta1, Theta2 - parameters of psychometric function obtained%% default to Weibull fitif exist('Dist')~=1,	Dist='weib';end% create stimulus filesfprintf(1,'initializing ...\n');InitSDS(StimA,StimB,StimLev);% collect trials needed for psychometric functionfprintf(1,'\nrunning trials ...\n');[ Trials, Theta1, Theta2 ] = SDSPsyMet( StimA, StimB, StimLev, ...	NTrials, Dist );% plot psychometric function and report fitPsyMetPlot(PsyMetFn(Trials,1,5));hold onfplot(sprintf('0.5+0.5*%scdf(x,%f,%f)',Dist,Theta1,Theta2), ...		[ min(StimLev), max(StimLev) ]);title([ 'Ideal ' StimA '-' StimB ' Psychometric Function' ]);xlabel 'Stimulus Level';hold offfprintf(1,'fit:  %5.3f, %5.3f\n',Theta1,Theta2);return