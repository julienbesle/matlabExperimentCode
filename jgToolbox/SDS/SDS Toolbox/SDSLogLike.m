function [ LogLike ] = SDSLogLike(Image,StimName,StimLevel)% SDSLogLike - determine SDS log likelihood of an image%%     [ LogLike ] = SDSLogLike(Image,StimName,StimLevel)%%     Image     - stimulus being evaluated%     StimName  - name of candidate stimulus%     StimLevel - stimulus level at which <Image> was generated%     LogLike   - log likelihood that <StimName> generated <Image>%UncProb = [ StimName 'Prob' ]; % name of uncertainty functionUncMax = feval(UncProb,-1);    % range of uncertainty vector% find expected image for all possible values of uncertainty vector,% and choose one with greatest likelihoodLogLike=-Inf;Unc = ones(size(UncMax));while 1,	% load image information	eval([ 'load ' StimFName(StimName,StimLevel,Unc) ]);	% determine next likelihood	LogLike = max(LogLike, ...		(sum(sum(Image.*Template))-Volume) + log(feval(UncProb,Unc)) );	% advance to next uncertainty vector	[ Unc Wrap ] = NextUnc(Unc,UncMax);	if Wrap==1,		break;	endendreturn