function [ Photo ] = PhotoImg( Img )% PhotoImg - create photoreceptor mosaic sample of image%%     [ Photo ] = PhotoImg( Img )%%     Img   - retinal image to be sampled%     Photo - sampled image%global RAF SCSigma% convolve with receptor aperture functionSImg=conv2(Img,RAF,'same');% multiply by Stiles-Crawford correction factorSImg=SCSigma*SImg;% multiply by absorptance spectrum of receptor photopigment% ( colour not implemented )% integrate with respect to wavelength% ( colour not implemented )% create hexagonal sample[ IM IN ] = size(SImg);PM = floor(sqrt(3)*IM/2);PN = floor((IN/2)-1);Photo=zeros(PM,PN);for i=1:PM,	for j=1:PN,		ipos=1+(2*(i-1))/sqrt(3);		jpos=2*j;		if rem(i,2)==0,			jpos=jpos+1;		end		it=floor(ipos);		ib=ceil(ipos);		if it==ib,			Photo(i,j)=SImg(it,jpos);		else			Photo(i,j)=SImg(it,jpos)+(ipos-it)*(SImg(ib,jpos)-SImg(it,jpos));		end	endendreturn