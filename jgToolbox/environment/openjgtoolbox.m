function open(name)% function open(name)%% opens an application using applescript. the name passed % is a shortcut that is hardcoded to a path and application% below. add new shortcuts by the command 'add' (i.e.,% 'open add'). a dialog box appears that allows the user to% choose the desired application, and a shortcut is entered% at the command prompt. N.B.: Sometimes an application will% not appear at the open file prompt. If this happens, the% shortcut has to be added manually below at "appended paths".% % type open ? to get a list of shortcuts and their paths.%% July 14, 1998 JMG  U of T Vision Lab% July 16, 1998: JMG added 'add' function% October 14, 1998:  JMG added '?' function to display shortcuts% the path and shortcut indicator stringspathstr = '			% appended paths';casestr = '			case ''';casestr = '			case ''';folderstr = ''', folder = ''';namestr = '''; name = ''';shortstr = '?';% file infofile = [mfilename,'.m'];eval(['mainpath=which(',quotestring(file),');']);mainpath = mainpath(1:end-length(file));% error handlingif ~exist('name','var')	printstr;	printstr('  Use:  open  <shortcutname or command>');	help open;% for the add functionelseif strcmp(name,shortstr)	fid = fopen([mainpath,file],'r+');	if fid ~= -1		printstr;		printstr(['Application Shortcuts:']);		printstr;		while ~feof(fid)			temp = fgetl(fid);			if length(temp) >= length([casestr])				if strcmp(temp(1:length([casestr])),casestr)					locfoldstr=findstr(temp,folderstr);					shortcut=temp(length(casestr)+1:locfoldstr-1);					locnamestr = findstr(temp,namestr);					shortpath=[temp(locfoldstr+length(folderstr):locnamestr-1),temp(locnamestr+length(namestr):end-2)];					printstr([shortcut,' = ',shortpath]);					end			end			end		fclose(fid);			else		printstr('There was a problem opening the main file.');		printstr('Make sure it is not already open (e.g., being edited).');	endelseif strcmp(name,'add')	% get the application to be appended	[app,apppath]=uigetfile('*.*','Chooser Application');	if app		str=input(['Application is ',app,'. Enter shortcut name: '],'s');			% file info		file = [mfilename,'.m'];		eval(['mainpath=which(',quotestring(file),');']);		mainpath = mainpath(1:end-length(file));			% first, check to see if shortcut already exists		fid = fopen([mainpath,file],'r+');		found = 0;		add=0;		if fid ~= -1			if length(str) == length('add')				if str == 'add'					printstr('"add" is a reserved shortcut.');					found = 1;					add = 1;				end					else				while ~feof(fid) & ~found					temp = fgetl(fid);					if length(temp) >= length([casestr,str])						if strcmp(temp(1:length([casestr,str])),[casestr,str])  							found = 1;						end					end				end			end			fclose(fid);			% append the new path if a shortcut name was passed			if ~nargin | found					if ~nargin					printstr('Not enough paramters passed.');				elseif ~add					printstr('Shortcut already exists.');				end					else				fid = fopen([mainpath,file],'r+');				found = 0;				while ~feof(fid) & ~found					temp = fgetl(fid);					if length(temp)==length(pathstr)						if strcmp(temp,pathstr)							newstr = ['\t\t\tcase ''',str,''', folder = ''',apppath,'''; name = ''',app,''';\n'];							found = 1;							pos = ftell(fid);						end					end				end				if found					[temp,items] = fread(fid,inf,'schar');					fseek(fid,pos,-1);					fprintf(fid,newstr);					items = fwrite(fid,temp,'schar');					else					printstr('No path indicator found.');					end				fclose(fid);			end		else			printstr('There was a problem opening the main file.');			printstr('Make sure it is not already open (e.g., being edited).');		end		end				% calls to shortcutselse	switch lower(name)			% do not move these.			% appended paths			case 'bb', folder = 'Ada:Applications:BBEdit Lite 4.1:'; name = 'BBEdit Lite 4.1';			case 'psych', folder = 'Ada:System Folder:Apple Menu Items: Internet:'; name = 'Psych.telnet';			case 'marathon', folder = 'Ada:Applications:Marathon:Marathon Infinity:'; name = 'Marathon ° 1.5';			case 'illustrator', folder = 'Ada:Applications:Adobe Illustrator¨ 6.0:'; name = 'Adobe Illustrator¨ 6.0';			case 'photoshop', folder = 'Ada:Applications:Adobe Photoshop 3.0:'; name = 'Adobe Photoshopª 3.0.4';			case 'cd', folder = 'Ada:Applications:'; name = 'AppleCD Audio Player';			case 'igor', folder = 'Ada:Applications:Igor Pro Folder:'; name = 'Igor Pro';			case 'chooser', folder = 'Ada:System Folder:Apple Menu Items:'; name = 'chooser';			case 'word', folder = 'Ada:Applications:Microsoft Office 98:'; name = 'Microsoft Word';			case 'excel', folder = 'Ada:Applications:Microsoft Office 98:'; name = 'Microsoft Excel';			case 'netscape', folder = 'Ada:Internet:Netscape Communicatorª Folder:'; name = 'Netscape Communicatorª';			case 'key', folder = 'Ada:System Folder:Control Panels:'; name = 'Keyboard';			end	% if it was found, open it	if exist('folder','var')		openapp(name,folder);	else			printstr('Application not found.');	endendreturn