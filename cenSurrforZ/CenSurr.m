% Center Surround behavioural experiment% Written by ER.% function [alldata, exptdesign] = CenSurrclear all; % clear the workspacestarttime=GetSecs;randn('state',sum(100*clock)); % initialize the random number generatorCenSurrParams; % initialize the parameters% subject informationgroupID=1;	% identifies group 1..4, -1=not setcd(mainpath); load nextidnum; defarg('sidnum',num2str(nextidnum)); nextidnum=nextidnum+1; save('nextidnum','nextidnum'); clear nextidnum;sgender=[];sage=[];scomment=[];smovement = 'h';ssession = [];startexperiment=0;while (startexperiment==0)	disp(' ');	disp('>>>>>>>>> ATTENTION <<<<<<<<<<');	disp(['Make sure that the viewing distance is ',num2str(exptdesign.viewingdistcm),' cm.']);	disp(' ');	disp('******** ?? CHANGE CURRENT SETTINGS ?? ********');	disp(['1......ID       (',sidnum,')']);	disp(['2......GENDER   (',sgender,')']);	disp(['3......AGE      (',num2str(sage),')']);	disp(['4......GROUP    (',num2str(groupID),')']);  	disp(['5.....SESSION  (',ssession,')']);    disp(['6......COMMENT  (',scomment,')']); 	disp(['7......LOAD PREVIOUS SETTINGS']);%  	disp(['9......calibration']);%    	disp(['10......horizontal (h) or vertical (v)?']);    disp(['b......Begin experiment']);	disp(['x......eXit experiment']);	tmpselect=lower(input('ENTER YOUR SELECTION >> ','s'));	switch tmpselect	case '1'		sidnum=[];		disp('');		while (isempty(sidnum))			sidnum=input('Subject ID: ','s');		end;		case '2'						sgender=[];		disp('');		while (isempty(sgender))			sgender=input('Gender: ','s');		end;		case '3'				sage=-1;		disp(' ');		while ((sage<1)|(sage>110))			sage=input('Subject''s age (1-110): ');		end;		case '4'		groupID=-1;		disp(' ');		while ((groupID<1)|(groupID>10))			groupID=input('Group (1-10): ');		end;            case '5'        ssession=1;        disp('');        while (isempty(ssession))        ssession=input('Session: ','s');        end;	case '6'		scomment=[];		disp('');		while (isempty(scomment))			scomment=input('Comment: ','s');		end;			case '7'		load subjsettings;	case '9'		[data,quitflag]=calibrateDisplay(scrinfo);        save 'calibrationData.mat' data;	  case '10'		smovement=[];		disp('');		while (isempty(smovement))			smovement=input('h or v: ','s');		end;        	case 'b'			startexperiment=1;			case 'x'		disp(' ');		yesno=input('Really exit (y/n)? ','s');		if (length(yesno)<1)|(lower(yesno)~='n')			return;		end;	end;end;% smovement = input('Horizontal (h) or vertical (v)?','s');save 'subjsettings' sidnum sgender sage groupID scomment smovement ssession; % save settings% we'll store some data in these variablesalldata=[];                         % data from each trialetime = zeros(1:exptdesign.numconds);for nn=1:exptdesign.numconds        starttime=GetSecs;        exptdesign.curBlock=nn;                      [data,screc(nn,:),quitflag]=CenSurrDisplay(stimparams,scrinfo,screc(nn,:),exptdesign);                endtime=GetSecs;        etime(nn)=(endtime-starttime)/60;        disp(['Elapsed time = ',num2str(etime(nn)),' minutes']);        alldata = [alldata; data];                if (quitflag)             disp('The experiment was aborted by the subject.');         end;        if quitflag            break        end;end;CenSurrWriteFile; % write data files to diskcd(mainpath); % restore original pathShowCursor;