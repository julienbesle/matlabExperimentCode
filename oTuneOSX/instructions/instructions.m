function [] = instructions(window, display, file)% function [] = instructions(window, display, file)%% Read a text file and display it. defarg('file','oTuneInstructions.txt');flushevents('keyDown');%page string and flagpagebreak = '***';done = 0;page = 1;%open instruction filetestStr = 0;fid = fopen(file, 'rt');eof = 0; counter = 1;while testStr ~= -1	testStr = fgetl(fid);	strLine{counter} = testStr;	counter = counter + 1;end % x/y initial co-ordinatesxpos = 10;ypos = 10;lineInc = 32;  % from 48 beforetextSize = 24; linesPerScreen = 26; % Was 20 numPages = ceil(size(strLine,2) ./ linesPerScreen);% key setupleftKey = '1';     rightKey = '2';escKey = '0';space_bar = 32;%fontsscreen(window,'TextFont','Helvetica');screen(window,'TextSize', textSize);page = 1;lpos = 1;counter = 1;redraw = 0;noRead = 0;breakFlag = 0;%activewire(1, 'OpenDevice');%activewire(1, 'SetDirection', zeros(1,16));while ~done	if breakFlag		break;	end	% put instructions to the screen	% x/y initial co-ordinates	xpos = 20;	ypos = 20;	if redraw		screen(window, 'FillRect', 1, display.rect);		redraw = 0;	end	for tmp = lpos : lpos+linesPerScreen		if tmp > size(strLine, 2) 			noRead = 1;		end		if ~noRead			testStr = strLine{tmp};		end		if (testStr == -1)			noRead = 1;			testStr = 'zzz';		end		if (testStr(1:3) == '***') 			[x, y] = screen(window, 'DrawText',' ', xpos, ypos, 2);		elseif ~noRead	 		[x, y] = screen(window, 'DrawText', strLine{tmp}, xpos, ypos, 2);		end		ypos = ypos + lineInc;	end			% get keys	  	[keydown, s] = kbcheck;%	portVal = activewire(1, 'GetPort');	if keydown 		key = getchar;	  	if (key == leftKey) & lpos ~= 1			lpos = lpos - linesPerScreen - 1;			redraw = 1;		elseif (key == rightKey) & ~(lpos + linesPerScreen >= size(strLine,2))   			lpos = lpos + linesPerScreen + 1;			redraw = 1;		elseif key == escKey | key == space_bar			done = 1;			breakFlag = 1;		elseif (key == rightKey) & (lpos + linesPerScreen >= size(strLine,2))			lpos = 1;	  	end		if noRead			lpos = 1;			noRead = 0;			redraw = 1;		end	end	flushevents('keyDown');  	[keydown, s] = kbcheck;%	if portVal(1) ~= 0 | portVal(2) == 0 | portVal(3) == 0 | portVal(4) == 0 | portVal(5) == 0 | portVal(6) == 0	if keydown		done = 1;		breakFlag = 1;	end	flushevents('keyDown');endfclose('all');%activewire(1, 'CloseDevice');return;