function [ newsrc, level, id ] = gettrial( src )% GETTRIAL  Poll a tslist trial source list%% [ newsrc, level, id ] = gettrial( src )% 28-Jan-98 -- created (RFM)% 27-Sep-98 -- made object-oriented (RFM)% trial sources are polled in a round-robin queue disciplinedone=0;while done==0,	isource=src.perm(src.iperm);	[ src.sources{isource}, level, id ] = gettrial( src.sources{isource} );	if isnan( level ),		src.active(isource)=0;	else		src.trial=src.trial+1;		src.prevsource=isource;		done=1;	end	src.iperm=src.iperm+1;	if src.iperm>size(src.perm,1),		src.iperm=1;		active=find(src.active);		if isempty(active),			id=NaN;			break		end		src.perm=active(randperm(size(active,1))');	end	endnewsrc=src;return