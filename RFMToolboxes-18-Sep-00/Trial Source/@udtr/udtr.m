function src = udtr( levels, criterion, maxreversals, id )% UDTR  Make a UDTR trial source%% src = udtr( levels, criterion, maxreversals, id )%% valid criteria are '50%', '71%', '74%', '79%', '84%'% 28-Jan-98 -- created (RFM)% 27-Sep-98 -- made object-oriented (RFM)% set default argumentsdefarg('criterion','79%');defarg('maxreversals',Inf);defarg('id',-1);% each row is [ criterion correctmax incorrectmax ]udtrtab = { ...	'50%',  1,  1  ;	'71%',  2,  1  ;	'74%',  5,  2  ;	'79%',  3,  1  ;	'84%',  4,  1  };% find column in udtrtabr=find( strcmp( { udtrtab{:,1} }, criterion ) );if isempty(r),	error(sprintf('Invalid criterion level ''%s''',criterion));endsrc.levels=levels(:);       % stimulus levelssrc.criterion=criterion;    % desired threshold levelsrc.id=id;                  % trial source idsrc.nlevels=size(src.levels,1);    % number of stimulus levelssrc.leveli=round(src.nlevels/2);   % index of current stimulus levelsrc.correct=0;                     % correct trialssrc.incorrect=0;                   % incorrect trialssrc.correctmax=udtrtab{r,2};       % maximum correct responsessrc.incorrectmax=udtrtab{r,3};     % maximum incorrect responsessrc.trial=0;                       % trial countersrc.maxreversals=maxreversals;  % number of reversals before expirysrc.preversals=0;  % practice reversals (not supported by interface)src.nreversals=0;  % number of reversals so farsrc.reversalsx=0;  % sum of stimulus levels at reversalssrc.dir='none';    % current direction% create objectsrc=class(src,'udtr');return