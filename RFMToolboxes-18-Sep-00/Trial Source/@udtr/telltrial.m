function newsrc = telltrial( src, level, success )% TELLTRIAL  Report result of a trial to a UDTR trial source%% newsrc = telltrial( src, level, success )% 28-Jan-98 -- created (RFM)% 27-Sep-98 -- made object-oriented (RFM)% 30-Sep-98 -- reversal counting added (RFM)% correct responseif success,	src.correct=src.correct+1;		% too many correct;  make task harder	if src.correct>=src.correctmax,		% reversal?		if strcmp(src.dir,'up'),			src.nreversals=src.nreversals+1;			if src.nreversals>src.preversals,				src.reversalsx=src.reversalsx+src.levels(src.leveli);			end		end		src.dir='down';				% decrease stimulus level		src.leveli=max(1,src.leveli-1);		src.correct=0;		src.incorrect=0;			end% incorrect responseelse	src.incorrect=src.incorrect+1;		% too many incorrect;  make task easier	if src.incorrect>=src.incorrectmax,				% reversal?		if strcmp(src.dir,'down'),			src.nreversals=src.nreversals+1;			if src.nreversals>src.preversals,				src.reversalsx=src.reversalsx+src.levels(src.leveli);			end		end		src.dir='up';					% increase stimulus level		src.leveli=min(src.nlevels,src.leveli+1);		src.correct=0;		src.incorrect=0;			endendnewsrc=src;return