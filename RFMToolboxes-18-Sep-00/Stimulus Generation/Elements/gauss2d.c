/*gauss2d.c -- make a 2D gaussianMATLAB usage:  gaussmat = gauss2d( dim, sigma )14/11/97 -- created (RFM)*/#include "mex.h"#include <math.h>/* prototypes */mxArray *gauss2d(int M,int N,double fSigma);/* gateway function */void mexFunction(int nlhs,mxArray *plhs[],int nrhs,const mxArray *prhs[]) {	/* check number and type of arguments */	/* parameters */	int M,N;	double fSigma;	double *pDim;		/* get parameters */	pDim = mxGetPr(prhs[0]);	M=(int)*pDim;	N=( mxGetM(prhs[0])>1 ? (int)*(pDim+1): M );	fSigma=fabs(mxGetScalar(prhs[1]));	plhs[0] = gauss2d(M,N,fSigma);	return;		}/* core routines */mxArray *gauss2d(int M,int N,double fSigma) {	int i,j;	int i0=ceil(M/2),j0=ceil(N/2);	int nColOffset;	double fNorm = 1/(sqrt(2*pi)*fSigma);	double fScale = 1/(2*fSigma*fSigma);	double fRyMag;	mxArray *pGaussArr = mxCreateDoubleMatrix(M,N,mxREAL);	double *pGaussMat = mxGetPr(pGaussArr);	for(j=0;j<N;j++) {		fRyMag=(j-j0)*(j-j0);		nColOffset=j*M;		for(i=0;i<M;i++)			*(pGaussMat+i+nColOffset)=fNorm*exp(-fScale*(fRyMag+(i0-i)*(i0-i)));		}		return( pGaussArr );	}