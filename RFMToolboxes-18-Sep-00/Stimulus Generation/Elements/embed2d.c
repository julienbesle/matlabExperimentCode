/*embed2d.c -- embed a matrix in a larger matrix at one or more locationsMATLAB usage:  newmat = embed2d( oldmat, submat, poslist )04/11/97 -- created (RFM)*/#include "mex.h"#include <math.h>/* prototypes */void embed2d(mxArray **ppNewMat,	const mxArray *pOldMat, const mxArray *pSubMat, const mxArray *pPosList);	/* interface function */void mexFunction(int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[])	{	embed2d(&(plhs[0]),prhs[0],prhs[1],prhs[2]);	}/* core routines */void embed2d(mxArray **ppNewMat,	const mxArray *pOldMat, const mxArray *pSubMat, const mxArray *pPosList)	{	/* get size of arrays */	int nLM=mxGetM(pOldMat),nLN=mxGetN(pOldMat);	int nSM=mxGetM(pSubMat),nSN=mxGetN(pSubMat);	int nPM=mxGetM(pPosList);	/* get pointers to arrays */	double *pOldMatR=mxGetPr(pOldMat);	double *pSubMatR=mxGetPr(pSubMat);	double *pPosListR=mxGetPr(pPosList);	double *pNewMatR;	/* calculate offsets from position vectors within which to embed array */	int nNegDelI=(int)floor((nSM-1)/2),nNegDelJ=(int)floor((nSN-1)/2);	/* loop variables */	int p,i,j,m,n;	/* duplicate old array */	*ppNewMat = mxDuplicateArray(pOldMat);	pNewMatR = mxGetPr(*ppNewMat);	/* insert submatrix at each position */	for(p=0;p<nPM;p++)		{		m=(int)(*(pPosListR+p))-(nNegDelI+1);		n=(int)(*(pPosListR+p+(1*nPM)))-(nNegDelJ+1);		for(i=0;i<nSM;i++)			for(j=0;j<nSN;j++)				*(pNewMatR+(m+i)+((n+j)*nLM))=*(pSubMatR+i+(j*nSM));		}	return;			}/*void embed2d(double *pImage,int IM,int IN,double *pDot,int DM,int DN,	int PM,int PN) {	/* calculate offsets from position vectors */	int nNegDelI=(int)floor((DM-1)/2),nNegDelJ=(int)floor((DN-1)/2);	/* loop variables */	int i,j;	/* copy submatrix into matrix */	for(i=0;i<DM;i++)		for(j=0;j<DN;j++)			*(pImage+((PM-nNegDelI)+i)+((PN-nNegDelJ)+j)*IM)=				max(*(pImage+((PM-nNegDelI)+i)+((PN-nNegDelJ)+j)*IM),					*(pDot+i+j*DM));	return;	}*/