function setconfig( action, value )% SETCONFIG  Set environment configuration parameters%% setconfig( action, value )%% valid actions%     - init%     - unit%     - origin%     - viewdistance%     - fgcind, bgcind%     - monitor%     - stimwindow%     - machine% 29-Apr-98 -- created (RFM)% 27-Oct-99 -- modified to use single global variable ENVIRON (RFM)% 03-Nov-99 -- name changed from setstim to setconfig (RFM)% set default argumentsdefarg('action','init');global ENVIRON% set defaults if not yet initialized or if reinitialization is requestedif isempty(ENVIRON) | strcmp(action,'init'),	ENVIRON=[];	load monitors DefaultMonitor Machine StimWindow	load('monitors',DefaultMonitor);	eval(sprintf('ENVIRON.monitor=%s;',DefaultMonitor));	ENVIRON.stimwindow=StimWindow;	ENVIRON.machine=Machine;	ENVIRON.viewdistance=1.14;	ENVIRON.unit=1;	ENVIRON.fgcind=255;	ENVIRON.bgcind=0;	ENVIRON.transform=[ 1 0 0 ; 0 1 0 ];	ENVIRON.pixelperdeg=1/datan2(ENVIRON.monitor.pixelsize,ENVIRON.viewdistance);end% set parametersif strcmp(action,'init')==0,	switch lower(action),		case 'unit',			switch lower(value),				case 'pixel', ENVIRON.unit='pixel'; ENVIRON.transform=[ 1 0 0 ; 0 1 0 ];				case 'deg',   ENVIRON.unit='deg';   ENVIRON.transform=(1/ENVIRON.pixelperdeg)*[ 1 0 0 ; 0 1 0 ];				otherwise error( sprintf('Unknown unit ''%s''',value) );			end					case 'origin',			if isstr(value) & strcmp(value,'topleft'),				ENVIRON.transform(:,3)=[ 0 ; 0 ];			elseif isstr(value),				error('Invalid origin');			else				ENVIRON.transform(:,3)=unit2pixel([ value(1) ; value(2) ]);			end					case 'viewdistance', ENVIRON.viewdistance=value;		case 'fgcind',  ENVIRON.fgcind=value;		case 'bgcind',  ENVIRON.bgcind=value;		case 'monitor', load('monitors',value); eval(sprintf('ENVIRON.monitor=%s;',value));		case 'stimwindow', ENVIRON.stimwindow=value;		case 'machine', ENVIRON.machine=value;		otherwise error( sprintf('Unknown action "%s".',action) );	endend% recalculate pixels per degreesENVIRON.pixelperdeg=1/datan2(ENVIRON.monitor.pixelsize,ENVIRON.viewdistance);return