/*qcframe.c -- get a frame from QuickCamMATLAB usage:  qcframe( winID )24/01/98 -- created (RFM)*/#include <stdarg.h>#include <stddef.h>#include <stdio.h>#include <stdlib.h>#include "mex.h"#include "Quickdraw.h"#include "QuickTimeComponents.h"/* prototype */void qcframe(WindowPtr dstWin);/* gateway function */void mexFunction(int nlhs,mxArray *plhs[],int nrhs,const mxArray *prhs[]) {	qcframe((WindowPtr)(long)mxGetScalar(prhs[0]));	return;	}/* core routine */void qcframe(WindowPtr dstWin){	SeqGrabComponent rSG;	SGChannel rVC;	Rect rBounds;	OSErr err=0;	/* make a sequence grabber */	rSG = OpenDefaultComponent(SeqGrabComponentType,0);	SGInitialize(rSG);	SGSetGWorld(rSG,(CGrafPtr)dstWin,nil);	/* make sequence grabber channel */	SGNewChannel(rSG,VideoMediaType,&rVC);	SetRect(&rBounds,0,0,320,240);	SGSetChannelBounds(rVC,&rBounds);	SGSetChannelUsage(rVC,seqGrabPreview|seqGrabRecord|seqGrabPlayDuringRecord);	/* initialize movie toolbox */	EnterMovies();	/* record */	SGSetMaximumRecordTime(rSG,60);	SGPrepare(rSG,true,true);	SGSetChannelMaxFrames(rVC,15);	SGStartRecord(rSG);	while(!err)		err=SGIdle(rSG);	if(err==grabTimeComplete)		err=0;			/* shut down sequence grabber */	SGStop(rSG);	CloseComponent(rSG);	return;	}