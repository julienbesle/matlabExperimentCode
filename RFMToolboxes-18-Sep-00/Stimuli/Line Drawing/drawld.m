function drawld( winID, fig, figsizeP, figthickP, theta, figcind )% DRAWLD  Draw a line drawing into a window%% drawld( winID, fig, figsizeP, figthickP, theta, figcind )% 08-Jun-99 -- created;  adapted from drawtpfig.m (RFM)% set default argumentsdefarg('figcind',1);% rotation matrixrmat=[ 1 0 ; 0 -1 ]*[ dcos(theta) -dsin(theta) ; dsin(theta) dcos(theta) ];% centre of screenwinRect=screen(winID,'Rect');winMid=rectmid(winRect);% number of lines to drawn=size(fig,1);% horizontal shift needed to centre main axisshifti=find(fig(:,5)==1);if fig(shifti,1)~=fig(shifti,3),	error('main axis is not vertical');endshiftx=(0.5-fig(shifti,1));% draw figure into movie framecls(winID,0);for i=1:n,	% determine pixel coordinates of endpoints	v1=(rmat*([ fig(i,1) ; fig(i,2) ]-[ 0.5-shiftx ; 0.5 ]))*figsizeP+winMid';	v2=(rmat*([ fig(i,3) ; fig(i,4) ]-[ 0.5-shiftx ; 0.5 ]))*figsizeP+winMid';	% calculate line angle, and set thickness accordingly	phi=datan2(-(v2(2)-v1(2)),v2(1)-v1(1));	thick=figthickP/(sqrt(2)*dcos(mod(phi,90)-45));	% draw line	screen(winID,'DrawLine',figcind,v1(1),v1(2),v2(1),v2(2),thick,thick);	end% draw fixation point% fixRect=centrerect(winRect,[ 0 0 3 3 ]);% screen(winID,'FillOval',figcind,fixRect);% draw circle around figure% screen(winID,'FrameOval',figcind,winRect,3,3);return