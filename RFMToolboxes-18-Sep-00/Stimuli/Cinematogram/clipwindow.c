/*clipwindow.c -- put a circular clip region on one or more windowsMATLAB usage:  clipwindow( winID, radius )24/01/98 -- created (RFM)*/#include <stdlib.h>#include <math.h>#include "mex.h"#include "Quickdraw.h"#define winpixmap( window ) (((CGrafPtr)window)->portPixMap)void clipwindow(const mxArray *pWinID,const int nRadius);/* gateway function */void mexFunction(int nlhs,mxArray *plhs[],int nrhs,const mxArray *prhs[]) {	clipwindow(prhs[0],mxGetScalar(prhs[1]));	return;	}/* main routine */void clipwindow(const mxArray *pWinID,const int nRadius) {	int w,midx,midy;	int nWinN=(int)mxGetM(pWinID)*mxGetN(pWinID);	double *pWinMat=mxGetPr(pWinID);	WindowPtr dstWin;	PixMapHandle dstPix;	Rect dstRect;		RgnHandle clipRgn;	GrafPtr savedPort;	Rect clipRect;	GetPort(&savedPort);	dstWin=(WindowPtr)(long)*pWinMat;	SetPort((GrafPtr)dstWin);	/* create circular clipping region */	dstPix=winpixmap( dstWin );	dstRect=(**dstPix).bounds;	midx=floor((dstRect.left+dstRect.right)/2);	midy=floor((dstRect.top+dstRect.bottom)/2);	clipRgn=NewRgn();	OpenRgn();	SetRect(&clipRect,midx-nRadius,midy-nRadius,midx+nRadius,midy+nRadius);	FrameOval(&clipRect);	CloseRgn(clipRgn);	SetClip(clipRgn);	DisposeRgn(clipRgn);	SetPort(savedPort);	return;}