function mat = mkrect( rectwidthP, rectheightP, rectthickP, rampP )% MKRECT  Make an anti-aliased outlined rectangle%% mat = mkrect( rectwidthP, rectheightP, rectthickP )% 25-Sep-99 -- created;  adapted from mksquare.m (RFM)% draw rectangleN=ceil((max(rectwidthP,rectheightP)+rectthickP)/2)+1;v=ones(2*N+1,1)*(-N:N);xy=v+sqrt(-1)*rot90(v,1);mat=highsquare(xy,rectwidthP/2,rectheightP/2,rectthickP/2);returnfunction f = highsquare( xy, x0, y0, w )f=zeros(size(xy));% check theseq=find( (imag(xy)>=0) & (imag(xy)>=(real(xy)-(x0-y0))) & (imag(xy)>=(-real(xy)+(-x0+y0))) );f(q)=trap(imag(xy(q))-y0,w);q=find( (imag(xy)<=0) & (imag(xy)<=(-real(xy)+(x0-y0))) & (imag(xy)<=(real(xy)-(-x0+y0))) );f(q)=trap(imag(xy(q))+y0,w);q=find( (real(xy)>=0) & (imag(xy)<=(real(xy)-(x0-y0))) & (imag(xy)>=(-real(xy)-(-x0+y0))) );f(q)=trap(real(xy(q))-x0,w);q=find( (real(xy)<=0) & (imag(xy)<=(-real(xy)-(x0-y0))) & (imag(xy)>=(real(xy)-(-x0+y0))) );f(q)=trap(real(xy(q))+x0,w);returnfunction y = trap( x, w )y=zeros(size(x));y(find(abs(x)<=w))=1;s=find( (abs(x)>w) & (abs(x)<(w+1)) );y(s)=1-(abs(x(s))-w);return