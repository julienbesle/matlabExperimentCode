function h = plotroc( hfmat, linflag, fitflag )% PLOTROC  Plot a ROC curve%% h = plotroc( hfmat, linflag, fitflag )% 06-Oct-98 -- created (RFM)% set default argumentsdefarg('linflag',0);defarg('fflag',1);washold=ishold;% linear axesif linflag,	% plot (H,F) pairs	plot(hfmat(2,:),hfmat(1,:),'r*-');	hold on	plot([ 0 1 ],[ 0 1 ],'b--');	text(0.25,0.25,'Chance performance');	graphrange(0,1,0,1);	xlabel 'False Alarms (F)';	ylabel 'Hits (H)';	title 'ROC (Linear)'	graphfont palatino 14 bold	% find and plot fit	if fitflag~=0,		fitfn=inline('normcdf(d+norminv(f,0,1),0,1)','f','d');		d=fit(fitfn,flipud(hfmat),1,'ss');		x=logspace(log10(.01),log10(1),500);		plot([ 0 x 1 ],[ 0 fitfn(x,d) 1 ],'g-');	end% z-scaled axeselse	% plot (H,F) pairs	zmat=z(hfmat);	plot(zmat(2,:),zmat(1,:),'r*-');	hold on	r=4;	plot([ -r r ],[ -r r ],'b--');	text(-2,-2,'Chance performance');	plot([ 0 0 ],[ -r r ],'b:');	plot([ -r r ],[ 0 0 ],'b:');	graphrange(-r,r,-r,r);	xlabel 'Z-Scaled False Alarms  z(F)';	ylabel 'Z-Scaled Hits  z(H)';	title 'ROC (Z-Scaled)'	graphfont palatino 14 bold	% find and plot fit	if fitflag~=0,		fitfn=inline('p(1)+p(2)*zF','zF','p');		f=fit(fitfn,flipud(zmat),[ 1 1 ],'ss');		plot([ -r r ],fitfn([ -r r ],f),'g-');	endendif ~washold,	hold offendreturn% inverse cumulative normal with mean=0.0, std=1.0function r = z( p )r=norminv(p,0,1);return