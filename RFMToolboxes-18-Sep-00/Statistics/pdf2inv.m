function invcdf = pdf2inv( pdfmat )% PDF2CDF  Convert a discrete PDF to a discrete inverse CDF%          (Result can be passed to simdrv.m to simulate a random variable)%% invcdf = pdf2inv( pdfmat )% 08-Dec-98 -- created; adapted from code written while at NYU (RFM)% check that probabilities sum to 1if abs(1-sum(pdfmat(:,2)))>0.01	error('Probabilities (column 2) do not sum to 1')end% create matrix giving inverse of cdf[ m, n ]=size(pdfmat);invcdf=zeros(m,n);invcdf(1,1)=pdfmat(1,2);invcdf(1,2)=pdfmat(1,1);for i=2:m,	invcdf(i,1)=invcdf(i-1,1)+pdfmat(i,2);	invcdf(i,2)=pdfmat(i,1);endreturn