function y = nanmean(x,dim)%NANMEAN Average or mean ignoring NaNs.%   NANMEAN(X,dim) returns the average treating NaNs as missing values.  %   For vectors, NANMEAN(X) is the mean value of the non-NaN%   elements in X.  For matrices, NANMEAN(X) is a row vector%   containing the mean value of each column, ignoring NaNs.%%   See also NANMEDIAN, NANSTD, NANMIN, NANMAX, NANSUM.%%   MODIFIED TO ACCEPT <dim> ARGUMENT, LIKE MEAN.M%   Copyright (c) 1993-97 by The MathWorks, Inc.%   $Revision: 2.7 $  $Date: 1997/04/08 15:07:37 $%   29-Apr-99 -- 'dim' argument added (RFM)if isempty(x) % Check for empty input.    y = NaN;    returnendif nargin==1,   dim = min(find(size(x)~=1));  if isempty(dim), dim = 1; endend% Replace NaNs with zeros.nans = isnan(x);i = find(nans);x(i) = zeros(size(i));% if min(size(x))==1,%   count = length(x)-sum(nans);% else%   count = size(x)-sum(nans);% endcount = size(x,dim)-sum(nans,dim);% Protect against a column of all NaNsi = find(count==0);count(i) = ones(size(i));y = sum(x,dim)./count;y(i) = i + NaN;