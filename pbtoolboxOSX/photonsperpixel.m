function [photonsperpixel,trolands]=photonsperpixel(luminance,diameter,pixelarea)% % function ppp=photonsperpixel(luminance,pupildiameter)%% parameters:% luminance: (photopic) stimulus luminance in cd/m^2% diameter: diameter of pupil in >>>mm<<<; if this parameter is empty ([]), then the function calls pupildiameterfromlum% pixelarea: area of individual pixel in >>>>>arcmin^2<<<<<<<%% returns:% photonsperpixel:	photons per pixel (per sec); converts lumens to an effective photon flux using the conversion% 					factor of 1 lumen = 4.1x10^15 photons (555nm equivalent) per second%% trolands:	trolands%% The equations were taken from Westheimer,G. (1966). The Maxwellian View. Vision Research, 6, 669-682.% The lumens-to-photons conversion factor was taken from Wyszecki & Stiles (1982) (see also, Westheimer, G.% (1985). The Oscilloscopic view: Retinal illuminance and contrast of point and line targets. Vision Research, 25(8), 1097-1103.%if (isempty(diameter))	diameter=pupildiameterfromlum(luminance);end;pupilarea=pi.*(diameter/2).^2; % pupil area in mm^2trolands = luminance.*pupilarea;lmpersteradian=trolands.*1e-6; % lumens per steradianlmsqarcmin=trolands.*0.85e-13; % lumens per arcmin^2lmperpixel=lmsqarcmin./pixelarea; % lumens per pixel (candelas)photonsperpixel=lmperpixel.*(4.1e15); % effective photon flux (555 nm equivalent)return;