function theImage=bar(nr,c,f,o);%% theImage=bar(nr,f,o);% Returns a sine wave grating. The grating is specified by% frequency (c/image), phase (deg), and orientation (deg). The phase is defined% relative to the center of the pattern. Horizontal and vertical correspond to 0 deg% and 90 deg, respectively (e.g., positive orientations are counterclockwise rotations% from horizontal).if (mod(nr,2)~=0)	nr=nr+1;end;nc=nr;x=0:(nc-1);x=x./nc;x=x-0.5;x=x*f;temp=c*cos(2*pi*x);period=1/f;xtemp=abs(abs(x)-(period/2));x0=find((xtemp==min(xtemp)));temp(1:x0(1))=0;temp(x0(2):nc)=0;if (o==90.0)	theImage=ones(1,nc)'*temp;end;if (o==0.0)	theImage=temp'*ones(1,nc);end;if ((o~=90)&(o~=0))	theImage=temp'*ones(1,nc);	temp=imrotate(theImage,o);	[tr,tc]=size(temp);	trect=setrect(0,0,tc,tr);	irect=setrect(0,0,nc-1,nr-1);	irect=centerrect(irect,trect);	T=irect(recttop);	B=irect(rectbottom);	L=irect(rectleft);	R=irect(rectright);	theImage=temp(T:B,L:R);end;return;