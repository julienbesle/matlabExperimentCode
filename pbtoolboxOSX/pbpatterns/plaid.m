function theImage=plaid(nr,f,p,o,b);%% theImage=plaid(numrows,freq1,phase1,orientation1,freq2,phase2,orientation2,b);% Returns a gaussian-windowed cosine wave. The cosine wave is specified by% frequency (c/image), phase (deg), and orientation (deg). The phase is defined% relative to the center of the pattern. Horizontal and vertical correspond to 0 deg% and 90 deg, respectively (e.g., positive orientations are counterclockwise rotations% from horizontal). Both the cosine wave and gaussian are written% to a square 2D matrix with a coordinate system that goes from -0.5 to +0.5, with% location <0,0> corresponding to the center of the matrix. The center of the% matrix is location <p,p>, where p = round(nr/2)+1.% The Gaussian is defined as Gauss(x) = exp(-pi*(x/b)^2).% The parameter b specifies the width, in image units, between the points at which the gaussian% is 0.043. For example, if you want a gassian that drops to 0.043 at x values% that are ±0.5 image units from the image's center, then you should pass a b value of 1.%	temp1=gabor(nr,f1,p1,o1,b);nc=nr;x=0:(nc-1);x=x./nc;x=x-0.5;x=x*f;p=p*pi/180;temp=cos(2*pi*x-p);if (o==90.0)	theImage=ones(1,nc)'*temp;end;if (o==0.0)	theImage=temp'*ones(1,nc);end;if ((o~=90)&(o~=0))	theImage=temp'*ones(1,nc);	temp=imrotate(theImage,o);	[tr,tc]=size(temp);	trect=setrect(0,0,tc,tr);	irect=setrect(0,0,nc-1,nr-1);	irect=centerrect(irect,trect);	T=irect(recttop);	B=irect(rectbottom);	L=irect(rectleft);	R=irect(rectright);	theImage=temp(T:B,L:R);end;x=0:(nc-1);x=x./nc;x=x-0.5;b=b/2;	% we divide b by 2 because the matrix goes from -0.5 to +0.5, not -1 to +1gx=exp(-pi*(x./b).^2);temp=gx'*ones(1,nc);temp2=ones(1,nc)'*gx;gw=temp.*temp2;theImage=theImage.*gw;return;