function [theImage,rs]=noise1d(nr,cvar,o,exact);%%	function theImage=noise1d(nr,cvar,o);%	nr == # of rows%	cvar == contrast variance%	o == orientation in deg (0 deg==horizontal; 90 deg == vertical)_%	exact == when ~= 0, function returns a wave with a variance that is EXACTLY cvar, otherwise%			 the variance is cvar ON AVERAGE.%	returns theImage, which is a nr x nc matrix, and rs, which is the seed for the random number generator%if (nargin<4)	exact=0;end;nc=nr;rs=randn('state');temp=randn(1,nc);if (exact~=0)	tv=var(temp);else	tv=1;end;temp=temp*sqrt(cvar/tv);	% temp now has a variance of cvarif (o==90.0)	theImage=ones(1,nc)'*temp;end;if (o==0.0)	theImage=temp'*ones(1,nc);end;if ((o~=90)&(o~=0))	theImage=temp'*ones(1,nc);	temp=imrotate(theImage,o);	[tr,tc]=size(temp);	trect=setrect(0,0,tc,tr);	irect=setrect(0,0,nc-1,nr-1);	irect=centerrect(irect,trect);	T=irect(recttop);	B=irect(rectbottom);	L=irect(rectleft);	R=irect(rectright);	theImage=temp(T:B,L:R);end;return;