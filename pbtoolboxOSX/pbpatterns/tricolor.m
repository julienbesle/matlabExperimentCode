function [rgbImage,rmask,gmask,bmask]=tricolor(nr,r,g,b);%%%guns=[r,g,b];gsum=r+g+b;guns=guns/gsum;nc=nr;dr=64;dotrect=SetRect(0,0,dr,dr);	%  newRect = SetRect(left,top,right,bottom);stimrect=SetRect(0,0,nc,nr);pixelSize=8;% [screenw,srect]=SCREEN(0,'OpenWindow',0);screenw=-1;[redPtr,rrect]=SCREEN(screenw,'OpenOffscreenWindow',255,stimrect,pixelSize);[greenPtr,grect]=SCREEN(screenw,'OpenOffscreenWindow',255,stimrect,pixelSize);[bluePtr,brect]=SCREEN(screenw,'OpenOffscreenWindow',255,stimrect,pixelSize);rdx=round((nc/2)-(dr/2)); rdy=round((nc/2)-(dr/3));;gdx=rdx-round(rdx/3);gdy=gdx;bdx=rdx+round(rdx/3);bdy=gdy;% SCREEN(windowPtr,'FillOval',[color],[rect])destRect = OffsetRect(dotrect,rdx,rdy); SCREEN(redPtr,'FillOval',64,destRect);destRect = OffsetRect(dotrect,gdx,gdy); SCREEN(greenPtr,'FillOval',64,destRect);destRect = OffsetRect(dotrect,bdx,bdy); SCREEN(bluePtr,'FillOval',64,destRect);rmask=SCREEN(redPtr,'GetImage');rmask=scale(rmask);gmask=SCREEN(greenPtr,'GetImage');gmask=scale(gmask);bmask=SCREEN(bluePtr,'GetImage');bmask=scale(bmask);screen('CloseAll');ri=rmask*guns(1);gi=gmask*guns(2);bi=bmask*guns(3);rgbImage=cat(3,ri,gi,bi);