function theImage=gp(nr,numdots,c,dx,dy,bkgrnd);%%%	if (nr<1)		disp('illegal value for # rows!');	end;	if (numdots<1)		disp('illegal value for # of dots!');	end;	if (length(c)~=length(dx))|(length(c)~=length(dy))		disp('lvectors c, dx, and dy must have equal lengths!');	end;	ds=4;	de=10;	nc=nr;	theImage=bkgrnd+zeros(nr,nc);	numpoints=nr*nc;	[xloc,yloc]=randcoords(nr,nc,de,numdots);	dotloc=xy21d(xloc,yloc,nc);	%dotloc=1+floor(numpoints*rand(1,numdots));	c=round(127*c+127);	ctemp=find(c<1);	if (length(ctemp)>0)		c(ctemp)=ones(1,length(ctemp));	end;	ctemp=find(c>254);	if (length(ctemp)>0)		c(ctemp)=254+zeros(1,length(ctemp));	end;	dotrect=SetRect(0,0,ds,ds);	%  newRect = SetRect(left,top,right,bottom);	stimrect=SetRect(0,0,nc,nr);	pixelSize=8;  	[swindow,srect]=SCREEN(0,'OpenWindow',128);	[windowPtr,pixrect]=SCREEN(swindow,'OpenOffscreenWindow',128,stimrect,pixelSize);	for k0=1:length(c)		xloc=xloc+dx(k0); xloc=1+mod(xloc,nc);		yloc=yloc+dy(k0); yloc=1+mod(yloc,nr);		for c0=1:length(xloc) 			destRect = OffsetRect(dotrect,xloc(c0),yloc(c0));			SCREEN(windowPtr,'FillRect',c(k0),destRect)		end;			end;	theImage=SCREEN(windowPtr,'GetImage');screen('CloseAll');	return;		