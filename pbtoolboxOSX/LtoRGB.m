function [rgb,rgblum,index]=LtoRGB(lum,calmatrix)% function [rgb,rgblum,index]=LtoRGB(lum,calmatrix)%% Finds the RGB in that corresponds most closely to a luminance.% It uses the calibration matrix created by Jason's routines.% This function is equivalent to the inverse of Jason's rgbtol routine.% The function returns 3 values:% rgb    : the 3-element array corresponding to the RGB value% rgblum : the actual luminance corresponding to rgb (N.B. it may be different from the one you want)% index  : the index in calmatrix corresponding to rgb & rgblum%	tmpLum=calmatrix(:,4); % the luminances are in column 4	tmpDiff=abs(tmpLum-lum); % calculate the difference	[y,index]=min(tmpDiff); % find the smallest difference	rgb=calmatrix(index,1:3);	rgblum=calmatrix(index,4);return;	