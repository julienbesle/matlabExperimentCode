function lum = pbPelliPower(x,values)% function lum = pellipower(x,value)%% the value of the pelli gamma function at the values% passed in [values]. [values] can be a scalar or a vector.% the function is defined as:% x = [alpha beta kappa gamma]%%	L(v)/cdm^2 = a + (b + kv)^g  {if b + kv >= 0}%				 a				 {otherwise}%% From:  Pelli, D.G. & Zhang, L. (1991). "Accurate control% 		 of contrast on microcomputer displays". Vision %		 Research, 31-7/8, 1137-1350.%% Dependencies: none.%% July 1998  JMG U of T Vision Lablocs=find(x(2)+x(3)*values<0);lum = x(1) + (x(2)+x(3)*values).^x(4);lum(locs) = x(1);tol=1e-4;tmp0=find(lum<=0);if(length(tmp0)>0)    lum(tmp0)=tol;end;return