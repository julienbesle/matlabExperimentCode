function thewave=wgrating(nc,f,c,p);%% thewave=wgrating(numcol,freq, contrast, phase);%% Returns a row vector containing a sine wave. The grating is specified by% frequency (c/image), contrast, and phase (deg).% Phase is defined relative to the center of the pattern.%if (nargin<4)	disp('ERROR IN wgrating: The function requires 4 input parameters.');	thewave=NaN;	return;end;x=0:(nc-1);x=x./nc;x=x-0.5;x=x*f;p=p*pi/180;thewave=c*cos(2*pi*x-p);return;