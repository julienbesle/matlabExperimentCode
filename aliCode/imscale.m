function newim = imscale( im, range, stoch, mu, nstd )% IMSCALE  Scale an image so that all values lie in a specified range%% newim = imscale( im, range, stoch, mu, nstd )% 09-Apr-01 -- arguments <stoch>, <mu>, <nstd> added (RFM)% set default argumentsdefarg('range',[ 0 1 ]);defarg('stoch',0);defarg('mu',0);defarg('nstd',2);% scale noisy imageif stoch,	s=sqrt(mean( (im(:)-mu).^2 ));	newim=(im-mu)/(nstd*s);	newim(find(newim<-1))=-1;	newim(find(newim>1))=1;	newim=mean(range)+0.5*(range(2)-range(1))*newim;% scale deterministic imageelse	ma=max(im(:));	mi=min(im(:));	newim=range(1)+(range(2)-range(1))*(im-mi)/(ma-mi);endreturn